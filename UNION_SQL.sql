SELECT
CUSTOMER_STATE
,CUSTOMER_CITY
,COUNT(*) AS COUNT_OF_CUSTOMERS

FROM (
SELECT
CUSTOMER_STATE
,CUSTOMER_CITY
,CUSTOMER_ID

FROM EXAMPLE.NEW_CUSTOMER
WHERE CUSTOMER_ID IS NOT NULL
AND CUSTOMER_STATE = 'MO'

GROUP BY 
CUSTOMER_STATE
,CUSTOMER_CITY

UNION

SELECT
CUSTOMER_STATE
,CUSTOMER_CITY
,CUSTOMER_ID

FROM EXAMPLE.OLD_CUSTOMER
WHERE CUSTOMER_ID IS NOT NULL
AND CUSTOMER_STATE = 'MO'

GROUP BY 
CUSTOMER_STATE
,CUSTOMER_CITY
)

GROUP BY 
CUSTOMER_STATE
,CUSTOMER_CITY

ORDER BY 
CUSTOMER_STATE
,CUSTOMER_CITY

WITH UR;